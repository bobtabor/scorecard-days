<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macro Scorecard - May 22, 2025</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1080px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .nav {
            margin-bottom: 20px;
        }
        .nav a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        .nav a:hover {
            text-decoration: underline;
        }
        .scorecard-summary {
            display: flex;
            gap: 30px;
            margin: 20px 0;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 8px;
        }
        .scorecard-section {
            flex: 1;
            text-align: center;
        }
        .score-value {
            font-size: 36px;
            font-weight: bold;
            margin: 10px 0;
        }
        .v1-score { color: #3498db; }
        .v2-score { color: #9b59b6; }
        .section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .component {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid #bdc3c7;
            background: #f8f9fa;
        }
        .component-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .component-name {
            font-weight: 600;
            color: #2c3e50;
        }
        .component-name a {
            color: #3498db;
            text-decoration: none;
        }
        .component-name a:hover {
            text-decoration: underline;
        }
        .component-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .component-status.pass {
            background: #d5f4e6;
            color: #27ae60;
        }
        .component-status.fail {
            background: #fadbd8;
            color: #e74c3c;
        }
        .component-details {
            font-size: 14px;
            color: #7f8c8d;
        }
        .metric {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .metric-name {
            font-weight: 500;
        }
        .metric-name a {
            color: #3498db;
            text-decoration: none;
        }
        .metric-name a:hover {
            text-decoration: underline;
        }
        .metric-value {
            font-weight: bold;
            color: #2980b9;
        }
        .charts-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        .chart-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background: #1a1a1a;
        }
        .chart-title {
            color: #ffffff;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        .chart-root {
            position: relative;
            width: 100%;
            height: 640px;
        }
        .footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #7f8c8d;
            font-size: 12px;
            text-align: center;
        }
        
        /* KPI Explanations Enhanced Styling */
        .explanations-section {
            margin-top: 40px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 25px;
        }
        
        .explanations-intro {
            font-style: italic;
            color: #6c757d;
            margin-bottom: 30px;
            font-size: 16px;
            line-height: 1.5;
            padding: 15px;
            background: #e9ecef;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }
        
        .explanation-category {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .explanation-category:last-child {
            border-bottom: none;
        }
        
        .explanation-category h3 {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 25px;
            color: #495057;
            border-bottom: 1px solid #ced4da;
            padding-bottom: 8px;
        }
        
        .explanation-item {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .explanation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f8f9fa;
        }
        
        .explanation-header h4 {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
            flex: 1;
        }
        
        .explanation-score {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .explanation-score.pass {
            background: #d5f4e6;
            color: #27ae60;
            border: 2px solid #27ae60;
        }
        
        .explanation-score.fail {
            background: #fadbd8;
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }
        
        .metric-current-value {
            background: #e3f2fd;
            color: #1976d2;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            border: 2px solid #1976d2;
        }
        
        .explanation-description {
            font-size: 16px;
            color: #495057;
            margin-bottom: 20px;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .component-current-values {
            background: #fff3cd;
            color: #856404;
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
            font-size: 14px;
        }
        
        .component-current-values strong {
            color: #6c5ce7;
            font-weight: 600;
        }
        
        .explanation-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #17a2b8;
        }
        
        .explanation-section {
            margin-bottom: 18px;
        }
        
        .explanation-section:last-child {
            margin-bottom: 0;
        }
        
        .explanation-section strong {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #343a40;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .explanation-section p {
            margin: 0;
            color: #6c757d;
            line-height: 1.5;
        }
        
        .explanation-section ul {
            margin: 0;
            padding-left: 20px;
            color: #6c757d;
        }
        
        .explanation-section li {
            margin-bottom: 6px;
            line-height: 1.5;
        }
        
        .metric-explanation {
            border-left: 4px solid #9b59b6;
        }
        
        .metric-explanation .explanation-details {
            border-left-color: #9b59b6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav">
            <a href="2025-05-23.html">‚Üê May 23</a> | <a href="index.html">‚Üê Back to Home</a> | <a href="2025-05-21.html">May 21 ‚Üí</a>
        </div>
        <h1>Macro Scorecard - May 22, 2025</h1>
        <div class="scorecard-summary">
            <div class="scorecard-section">
                <h3>V1 Scorecard (Original)</h3>
                <div class="score-value v1-score">2/6</div>
            </div>
            <div class="scorecard-section">
                <h3>V2 Scorecard (New)</h3>
                <div class="score-value v2-score">4/9</div>
            </div>
        </div>
        <div class="charts-section">
            <div class="chart-container">
                <div class="chart-title">SPY Chart</div>
                <div id="spy-chart" class="chart-root"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">QQQ Chart</div>
                <div id="qqq-chart" class="chart-root"></div>
            </div>
        </div>
        <div class="section">
            <h2>V1 Components</h2>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#10-day-successful-new-high-index">10-Day New High Index</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">eligible_stocks: 100; successful_stocks: 66; success_rate: 66.0%</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#new-highs-today-count">New Highs Today</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">new_highs_count: 45; total_symbols: 5604; threshold: 100</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-daily-trend-status">QQQ Daily Trend</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">symbol: QQQ; weekly_close: 521.51; ma_10w: 475.58</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#spy-daily-trend-status">SPY Daily Trend</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">symbol: SPY; weekly_close: 594.20; ma_10w: 554.43</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-weekly-trend-status">QQQ Weekly Trend</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">symbol: QQQ; ma_10w_rising: False; ma_30w_rising: False</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#mtum-vs-50-day-moving-average">MTUM vs 50-Day MA</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">current_price: 226.26; ma_50: 207.27; ma_rising: False</div>
                </div>
            
        </div>
        <div class="section">
            <h2>V2 Components</h2>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#more-new-highs-than-new-lows-today">V2 New Highs vs Lows</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">new_highs_count: 45; new_lows_count: 97; result: Fail</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-above-10-week-ma">QQQ Above 10-Week MA</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">current_close: 514.00; 10_week_ma: 475.58; result: Pass</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-above-4-week-ma">QQQ Above 4-Week MA</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">current_close: 514.00; 4_week_ma: 503.08; result: Pass</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-above-10-day-ma">QQQ Above 10-Day MA</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">current_close: 514.00; 10_day_ma: 514.02; result: Fail</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-moving-average-hierarchy">V2 QQQ Weekly Trend Hierarchy</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">4_week_ma: 503.08; 10_week_ma: 475.58; 30_week_ma: 501.13</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-stochastic-104-20">QQQ Stochastic [10,4] < 20</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">stoch_k: 85.95; result: Fail</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-stochastic-101-20">QQQ Stochastic [10,1] <= 20</a></span>
                        <span class="component-status fail">FAIL</span>
                    </div>
                    <div class="component-details">stoch_k: 75.55; result: Fail</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-macd-histogram-rising">V2 QQQ MACD Histogram</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">current_histogram: 1.72; prev_histogram: 2.67; prev2_histogram: 3.90</div>
                </div>
            
                <div class="component">
                    <div class="component-header">
                        <span class="component-name"><a href="#qqq-stochastic-momentum-signal">V2 QQQ Stochastic Momentum</a></span>
                        <span class="component-status pass">PASS</span>
                    </div>
                    <div class="component-details">stoch_k_fast: 85.95; stoch_d_slow: 93.06; fast_above_slow: False</div>
                </div>
            
        </div>
        <div class="section">
            <h2>Aggregate Metrics</h2>
            
                <div class="metric">
                    <div class="metric-name"><a href="#consecutive-days-qqq-above-ema-21">QQQ EMA 21 Streak</a></div>
                    <div class="metric-value">21</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#consecutive-weeks-qqq-above-10-week-average">QQQ Weekly 10MA Streak</a></div>
                    <div class="metric-value">4</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#consecutive-weeks-spy-above-10-week-average">SPY Weekly 10MA Streak</a></div>
                    <div class="metric-value">4</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#consecutive-weeks-qqq-ma-hierarchy-bullish">QQQ Weekly Trend Streak</a></div>
                    <div class="metric-value">0</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#percentage-of-stocks-above-40-day-sma">Stocks Above 40-Day SMA %</a></div>
                    <div class="metric-value">64.6%</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#nasdaq-100-stocks-above-macd-signal-line">NASDAQ 100 Above MACD Signal</a></div>
                    <div class="metric-value">72.20</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#qqq-weekly-stochastic-reading">QQQ Weekly Stochastic</a></div>
                    <div class="metric-value">84.44</div>
                </div>
            
                <div class="metric">
                    <div class="metric-name"><a href="#daily-market-advance-decline-statistics">Advance Decline Metrics</a></div>
                    <div class="metric-value">2523/2929 (Net: -406)</div>
                </div>
            
        </div>
        
        <div class="section explanations-section">
            <h2>üìä KPI & Metrics Explanations</h2>
            <p class="explanations-intro">
                This section provides detailed explanations of all Key Performance Indicators (KPIs) and metrics used in the Macro Scorecard analysis. 
                Understanding these components helps interpret the market health assessment and scoring methodology.
            </p>
        
            <div class="explanation-category">
                <h3>üîµ V1 Scorecard Components (Original)</h3>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="10-day-successful-new-high-index">10-Day Successful New High Index</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Measures the success rate of stocks that made new highs 10 trading days ago.</p>
            <div class="component-current-values"><strong>Current Values:</strong> eligible_stocks: 100 ‚Ä¢ successful_stocks: 66 ‚Ä¢ success_rate: 66.0%</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Identify all stocks that made a 52-week high exactly 10 trading days ago</li><li>2. Compare today's closing price to the closing price 10 days ago for each stock</li><li>3. Calculate success rate: (Stocks with current close ‚â• D-10 close) √∑ (Total eligible stocks)</li><li>4. Requires minimum 20 eligible stocks for validity</li><li>5. Passes if success rate ‚â• 50%</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>A high success rate indicates sustained momentum and market strength. Stocks making new highs should continue to perform well in healthy markets.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if both valid (‚â•20 stocks) AND healthy (‚â•50% success rate)</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>This indicator measures follow-through strength after breakouts, which is a key sign of market health.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="new-highs-today-count">New Highs Today Count</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Counts the number of stocks making new highs on the current trading day.</p>
            <div class="component-current-values"><strong>Current Values:</strong> new_highs_count: 45 ‚Ä¢ total_symbols: 5604 ‚Ä¢ threshold: 100</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Identify stocks making new highs today (52-week or all-time configurable)</li><li>2. Compare against historical prices using high or close price (configurable)</li><li>3. Optional volume confirmation: today's volume ‚â• 120% of 50-day average volume</li><li>4. Count total qualifying stocks</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>A healthy market should have significant breadth with many stocks participating in upward moves. ‚â•100 stocks making new highs indicates broad market participation.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if ‚â•100 stocks make new highs</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Market breadth is crucial - a few large stocks can't carry the entire market sustainably.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-daily-trend-status">QQQ Daily Trend Status</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Evaluates NASDAQ-100 trend using weekly moving averages, checked every trading day.</p>
            <div class="component-current-values"><strong>Current Values:</strong> symbol: QQQ ‚Ä¢ weekly_close: 521.51 ‚Ä¢ ma_10w: 475.58</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate weekly closes for QQQ (Friday or last trading day of week)</li><li>2. Calculate 10-week and 30-week moving averages of weekly closes</li><li>3. Each trading day, use the most recent weekly close and moving averages</li><li>4. Apply trend criteria: Weekly close ‚â• 30-week MA AND 10-week MA ‚â• 30-week MA</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Technology stocks (NASDAQ) often lead market moves. Strong QQQ trend indicates healthy market leadership in growth sectors. This component updates every trading day using the latest weekly data.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if trend criteria are met (Lenient: Weekly close ‚â• 30-week MA AND 10-week MA ‚â• 30-week MA; Strict: + rising MAs)</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>QQQ represents the innovation and growth engine of the US market. Daily evaluation provides immediate feedback on trend changes.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="spy-daily-trend-status">SPY Daily Trend Status</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Evaluates S&P 500 trend using identical methodology to QQQ Daily Trend.</p>
            <div class="component-current-values"><strong>Current Values:</strong> symbol: SPY ‚Ä¢ weekly_close: 594.20 ‚Ä¢ ma_10w: 554.43</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Same methodology as QQQ Daily Trend</li><li>2. Uses SPY weekly closes instead of QQQ</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Broad market health assessment through the most widely followed market index representing 500 largest US companies.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if trend criteria are met (same as QQQ)</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>SPY provides the foundational broad market trend confirmation.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-weekly-trend-status">QQQ Weekly Trend Status</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Weekly-specific evaluation of QQQ trend, only evaluated on week-end days (Friday or last trading day).</p>
            <div class="component-current-values"><strong>Current Values:</strong> symbol: QQQ ‚Ä¢ ma_10w_rising: False ‚Ä¢ ma_30w_rising: False</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Only evaluates on Friday (or last trading day of the week if Friday is a holiday)</li><li>2. Calculate weekly closes for QQQ</li><li>3. Calculate 10-week and 30-week moving averages of weekly closes</li><li>4. Apply trend criteria: Weekly close ‚â• 30-week MA AND 10-week MA ‚â• 30-week MA</li><li>5. On non-week-end days (Mon-Thu), returns 0 with note 'Not evaluated today'</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Provides weekly perspective confirmation of QQQ trend status. Unlike the Daily version, this only updates once per week, filtering out intra-week noise and confirming the medium-term trend.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if weekly trend criteria are met (on week-end days only)</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Weekly-only analysis ensures the signal is based on completed weekly data, avoiding premature signals from incomplete weeks.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="mtum-vs-50-day-moving-average">MTUM vs 50-Day Moving Average</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Evaluates momentum factor performance relative to its moving average.</p>
            <div class="component-current-values"><strong>Current Values:</strong> current_price: 226.26 ‚Ä¢ ma_50: 207.27 ‚Ä¢ ma_rising: False</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Compare MTUM current price to its 50-day moving average</li><li>2. Optionally require the 50-day MA to be rising (slope > epsilon)</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Momentum factors performing well indicates market participants are rewarding growth and momentum, suggesting risk-on sentiment.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if above 50-day MA AND (if configured) MA is rising</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>MTUM outperformance signals that investors are favoring growth over defensive strategies.</p>
                </div>
            </div>
        </div>
        </div>
            <div class="explanation-category">
                <h3>üü£ V2 Scorecard Components (New)</h3>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="more-new-highs-than-new-lows-today">More New Highs than New Lows Today</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Compares the count of stocks making new highs versus new lows on the current trading day.</p>
            <div class="component-current-values"><strong>Current Values:</strong> new_highs_count: 45 ‚Ä¢ new_lows_count: 97 ‚Ä¢ result: Fail</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Count stocks making new highs today (same universe as V1)</li><li>2. Count stocks making new lows today (all-time lows, using low price field)</li><li>3. Compare: New Highs > New Lows</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>When more stocks are making new highs than new lows, it indicates broad market strength and positive momentum across the market.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if New Highs > New Lows</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Market breadth indicator showing whether strength or weakness is more prevalent.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-above-10-week-ma">QQQ Above 10-Week MA</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Evaluates whether QQQ's weekly closing price is trading above its 10-week moving average.</p>
            <div class="component-current-values"><strong>Current Values:</strong> current_close: 514.00 ‚Ä¢ 10_week_ma: 475.58 ‚Ä¢ result: Pass</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate 10-week moving average of QQQ weekly closes</li><li>2. Compare current week's close to 10-week MA</li><li>3. Pass if current close > 10-week MA</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>When QQQ trades above its 10-week moving average, it indicates a medium-term uptrend is intact.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if QQQ close > 10-week MA</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>The 10-week MA represents intermediate-term trend direction. Trading above it confirms medium-term bullish momentum.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-above-4-week-ma">QQQ Above 4-Week MA</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Evaluates whether QQQ's weekly closing price is trading above its 4-week moving average.</p>
            <div class="component-current-values"><strong>Current Values:</strong> current_close: 514.00 ‚Ä¢ 4_week_ma: 503.08 ‚Ä¢ result: Pass</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate 4-week moving average of QQQ weekly closes</li><li>2. Compare current week's close to 4-week MA</li><li>3. Pass if current close > 4-week MA</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>When QQQ trades above its 4-week moving average, it indicates a short-term uptrend is intact.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if QQQ close > 4-week MA</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>The 4-week MA represents short-term trend direction. Trading above it confirms recent bullish momentum.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-above-10-day-ma">QQQ Above 10-Day MA</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Evaluates whether QQQ's daily closing price is trading above its 10-day moving average.</p>
            <div class="component-current-values"><strong>Current Values:</strong> current_close: 514.00 ‚Ä¢ 10_day_ma: 514.02 ‚Ä¢ result: Fail</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate 10-day moving average of QQQ daily closes</li><li>2. Compare current close to 10-day MA</li><li>3. Pass if current close > 10-day MA</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>When QQQ trades above its 10-day moving average, it indicates very short-term uptrend momentum.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if QQQ close > 10-day MA</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>The 10-day MA represents very short-term trend direction. Trading above it confirms immediate bullish momentum.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-moving-average-hierarchy">QQQ Moving Average Hierarchy</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Checks if QQQ's moving averages are in proper bullish order.</p>
            <div class="component-current-values"><strong>Current Values:</strong> 4_week_ma: 503.08 ‚Ä¢ 10_week_ma: 475.58 ‚Ä¢ 30_week_ma: 501.13</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate QQQ's 4-week, 10-week, and 30-week averages</li><li>2. Verify: 4-week MA > 10-week MA > 30-week MA</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>When shorter-term averages are above longer-term averages, it confirms a strong bullish trend structure.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if 4w MA > 10w MA > 30w MA</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Proper MA hierarchy indicates sustained trend momentum rather than temporary moves.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-stochastic-10-4-<-20">QQQ Stochastic [10,4] < 20</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Uses stochastic oscillator with [10,4,3] settings to identify oversold conditions in QQQ.</p>
            <div class="component-current-values"><strong>Current Values:</strong> stoch_k: 85.95 ‚Ä¢ result: Fail</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate stochastic oscillator with K-period=10, K-slowing=4, D-period=3</li><li>2. Check if %K value is less than 20</li><li>3. Pass if stochastic %K < 20</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Oversold conditions (< 20) often precede bounces in uptrending markets. This setting uses moderate smoothing for reliable signals.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if stochastic [10,4,3] < 20</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Oversold conditions in uptrending markets often represent tactical buying opportunities as momentum resets.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-stochastic-10-1-<=-20">QQQ Stochastic [10,1] <= 20</h4>
                <span class="explanation-score fail">FAIL</span>
            </div>
            <p class="explanation-description">Uses stochastic oscillator with [10,1,3] settings to identify oversold conditions in QQQ.</p>
            <div class="component-current-values"><strong>Current Values:</strong> stoch_k: 75.55 ‚Ä¢ result: Fail</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate stochastic oscillator with K-period=10, K-slowing=1, D-period=3</li><li>2. Check if %K value is less than or equal to 20</li><li>3. Pass if stochastic %K ‚â§ 20</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>This faster stochastic (minimal smoothing) identifies oversold conditions more quickly, useful for short-term timing.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if stochastic [10,1,3] ‚â§ 20</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Faster stochastic settings provide earlier oversold signals for more aggressive entry timing in uptrends.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-macd-histogram-rising">QQQ MACD Histogram Rising</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Evaluates MACD histogram momentum for QQQ to identify trend acceleration.</p>
            <div class="component-current-values"><strong>Current Values:</strong> current_histogram: 1.72 ‚Ä¢ prev_histogram: 2.67 ‚Ä¢ prev2_histogram: 3.90</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate MACD [12,26,9] for QQQ</li><li>2. Check if histogram is rising over last two days OR positive (> 0)</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Rising MACD histogram indicates increasing bullish momentum. Positive histogram confirms bullish momentum is present.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if histogram is rising in last 2 days OR > 0</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>MACD histogram shows the rate of change in momentum - rising indicates accelerating bullish momentum.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item">
            <div class="explanation-header">
                <h4 id="qqq-stochastic-momentum-signal">QQQ Stochastic Momentum Signal</h4>
                <span class="explanation-score pass">PASS</span>
            </div>
            <p class="explanation-description">Uses stochastic to identify momentum conditions in QQQ.</p>
            <div class="component-current-values"><strong>Current Values:</strong> stoch_k_fast: 85.95 ‚Ä¢ stoch_d_slow: 93.06 ‚Ä¢ fast_above_slow: False</div>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
                    <ul>
        <li>1. Calculate QQQ stochastic [10,4,4]</li><li>2. Check if %K (fast) > %D (slow) OR stochastic > 80</li>
                    </ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Fast stochastic above slow indicates building momentum. Values above 80 indicate strong momentum (overbought but strong).</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Scoring:</strong>
                    <p>1 point if %K > %D OR stochastic > 80</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Momentum signals help identify when strength is building or when markets are in strong trending phases.</p>
                </div>
            </div>
        </div>
        </div>
            <div class="explanation-category">
                <h3>üìà Aggregate Metrics</h3>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="consecutive-days-qqq-above-ema-21">Consecutive Days QQQ Above EMA 21</h4>
                <span class="metric-current-value">21 Days</span>
            </div>
            <p class="explanation-description">Current unbroken streak of days QQQ has closed above its 21-day Exponential Moving Average.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. Work backwards from today</li><li>2. Count consecutive days where QQQ close > EMA 21</li><li>3. Stop counting when QQQ closes below EMA 21</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Longer streaks indicate sustained bullish momentum. The 21-day EMA is a key short-to-medium term trend indicator.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Persistence above key moving averages shows trend strength and durability.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="consecutive-weeks-qqq-above-10-week-average">Consecutive Weeks QQQ Above 10-Week Average</h4>
                <span class="metric-current-value">4 Weeks</span>
            </div>
            <p class="explanation-description">Current unbroken streak of weeks QQQ has closed above its 10-week moving average.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. Work backwards from current week</li><li>2. Count consecutive weeks where QQQ weekly close > 10-week MA</li><li>3. Stop counting when QQQ closes below 10-week MA</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Weekly streaks show medium-term trend persistence. 10-week MA is approximately 2.5 months of data.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Weekly analysis filters daily noise and shows sustainable trend strength.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="consecutive-weeks-spy-above-10-week-average">Consecutive Weeks SPY Above 10-Week Average</h4>
                <span class="metric-current-value">4 Weeks</span>
            </div>
            <p class="explanation-description">Current unbroken streak of weeks SPY has closed above its 10-week moving average.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. Same methodology as QQQ weekly streak</li><li>2. Applied to SPY instead of QQQ</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Shows broad market trend persistence through the S&P 500. Complements QQQ streak for full market picture.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>SPY represents broad market health while QQQ represents growth/tech leadership.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="percentage-of-stocks-above-40-day-sma">Percentage of Stocks Above 40-Day SMA</h4>
                <span class="metric-current-value">64.6 Percentage</span>
            </div>
            <p class="explanation-description">Percentage of stocks in the universe currently trading above their 40-day Simple Moving Average.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. For each stock in universe, check if current close > 40-day SMA</li><li>2. Calculate: (Stocks above SMA 40) √∑ (Total stocks) √ó 100</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>High percentages (>70%) indicate broad market strength. Low percentages (<30%) suggest widespread weakness.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Breadth indicator showing what percentage of the market is in short-term uptrends.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="nasdaq-100-stocks-above-macd-signal-line">NASDAQ 100 Stocks Above MACD Signal Line</h4>
                <span class="metric-current-value">72.2 Count (out of ~100)</span>
            </div>
            <p class="explanation-description">Count of NASDAQ 100 constituent stocks currently above their MACD signal line.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. Fetch current NASDAQ 100 constituents</li><li>2. Calculate MACD for each stock</li><li>3. Count stocks where MACD line > MACD signal line</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Higher counts indicate broad momentum among leading technology stocks. Tracks momentum breadth in growth leaders.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>NASDAQ 100 represents market leadership - broad momentum here suggests healthy market leadership.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="qqq-weekly-stochastic-reading">QQQ Weekly Stochastic Reading</h4>
                <span class="metric-current-value">84 0-100 scale</span>
            </div>
            <p class="explanation-description">Current weekly stochastic oscillator reading for QQQ using 10-period lookback.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>1. Calculate weekly stochastic [10,4,3] for QQQ</li><li>2. Report current %K value</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Values >80 = overbought (strong but potentially extended), Values <20 = oversold (potentially undervalued), Values 20-80 = neutral zone</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Weekly stochastic helps identify when QQQ might be extended in either direction on a weekly basis.</p>
                </div>
            </div>
        </div>
        
        <div class="explanation-item metric-explanation">
            <div class="explanation-header">
                <h4 id="daily-market-advance-decline-statistics">Daily Market Advance/Decline Statistics</h4>
                <span class="metric-current-value">2523/2929 (Net: -406, Ratio: 0.86) Count, Ratio, Net</span>
            </div>
            <p class="explanation-description">Comprehensive advance/decline statistics for the trading day across all tracked stocks.</p>
            
            <div class="explanation-details">
                <div class="explanation-section">
                    <strong>Calculation Method:</strong>
        <ul><li>Simple Count: Advancers - Decliners</li><li>Ratio: Advancers √∑ Decliners</li><li>Net: Total advancing stocks minus total declining stocks</li></ul>
                </div>
                
                <div class="explanation-section">
                    <strong>Interpretation:</strong>
                    <p>Positive readings indicate more stocks rose than fell. Ratios >1.0 are bullish, <1.0 are bearish. Shows internal market strength.</p>
                </div>
                
                <div class="explanation-section">
                    <strong>Business Logic:</strong>
                    <p>Advance/decline data shows the internal health of the market beyond just price index movements.</p>
                </div>
            </div>
        </div>
        </div></div>
        <div class="footer">
            Generated on 2025-11-21 19:41 UTC
        </div>
    </div>
    <script>
        // Chart data
        const spyData = {"symbol": "SPY", "data": [{"date": "2025-02-24", "open": 602.02, "high": 603.03, "low": 596.49, "close": 597.21, "volume": 50737213, "ema_8": 604.74, "ema_21": 603.83, "sma_50": 599.03, "bb_upper": 613.54, "bb_middle": 604.42, "bb_lower": 595.29}, {"date": "2025-02-25", "open": 597.15, "high": 597.89, "low": 589.56, "close": 594.24, "volume": 58266472, "ema_8": 602.41, "ema_21": 602.96, "sma_50": 598.86, "bb_upper": 614.13, "bb_middle": 604.16, "bb_lower": 594.19}, {"date": "2025-02-26", "open": 595.93, "high": 599.58, "low": 591.86, "close": 594.54, "volume": 43321578, "ema_8": 600.66, "ema_21": 602.19, "sma_50": 598.6, "bb_upper": 614.52, "bb_middle": 603.66, "bb_lower": 592.8}, {"date": "2025-02-27", "open": 596.85, "high": 598.02, "low": 584.65, "close": 585.05, "volume": 74196664, "ema_8": 597.19, "ema_21": 600.63, "sma_50": 598.22, "bb_upper": 616.5, "bb_middle": 602.82, "bb_lower": 589.14}, {"date": "2025-02-28", "open": 585.56, "high": 594.72, "low": 582.44, "close": 594.18, "volume": 88744106, "ema_8": 596.52, "ema_21": 600.05, "sma_50": 598.02, "bb_upper": 616.44, "bb_middle": 602.28, "bb_lower": 588.12}, {"date": "2025-03-03", "open": 596.18, "high": 597.34, "low": 579.9, "close": 583.77, "volume": 74249199, "ema_8": 593.69, "ema_21": 598.57, "sma_50": 597.56, "bb_upper": 617.79, "bb_middle": 601.38, "bb_lower": 584.97}, {"date": "2025-03-04", "open": 579.71, "high": 585.39, "low": 572.25, "close": 576.86, "volume": 109648212, "ema_8": 589.95, "ema_21": 596.59, "sma_50": 597.01, "bb_upper": 620.04, "bb_middle": 600.33, "bb_lower": 580.62}, {"date": "2025-03-05", "open": 576.69, "high": 584.88, "low": 573.08, "close": 583.06, "volume": 71230528, "ema_8": 588.42, "ema_21": 595.36, "sma_50": 596.95, "bb_upper": 620.54, "bb_middle": 599.4, "bb_lower": 578.25}, {"date": "2025-03-06", "open": 575.48, "high": 580.17, "low": 570.12, "close": 572.71, "volume": 80094868, "ema_8": 584.93, "ema_21": 593.3, "sma_50": 596.68, "bb_upper": 621.94, "bb_middle": 597.82, "bb_lower": 573.7}, {"date": "2025-03-07", "open": 570.9, "high": 577.39, "low": 565.63, "close": 575.92, "volume": 81158816, "ema_8": 582.93, "ema_21": 591.72, "sma_50": 596.37, "bb_upper": 621.95, "bb_middle": 596.3, "bb_lower": 570.65}, {"date": "2025-03-10", "open": 567.59, "high": 569.54, "low": 555.59, "close": 560.58, "volume": 99326624, "ema_8": 577.96, "ema_21": 588.89, "sma_50": 595.69, "bb_upper": 624.38, "bb_middle": 594.29, "bb_lower": 564.21}, {"date": "2025-03-11", "open": 559.4, "high": 564.02, "low": 552.02, "close": 555.92, "volume": 88102109, "ema_8": 573.06, "ema_21": 585.89, "sma_50": 594.78, "bb_upper": 626.0, "bb_middle": 591.84, "bb_lower": 557.69}, {"date": "2025-03-12", "open": 562.17, "high": 563.11, "low": 553.69, "close": 558.87, "volume": 69588167, "ema_8": 569.91, "ema_21": 583.44, "sma_50": 593.93, "bb_upper": 626.05, "bb_middle": 589.52, "bb_lower": 552.99}, {"date": "2025-03-13", "open": 558.49, "high": 559.11, "low": 549.68, "close": 551.42, "volume": 74079414, "ema_8": 565.8, "ema_21": 580.53, "sma_50": 593.06, "bb_upper": 626.57, "bb_middle": 586.92, "bb_lower": 547.28}, {"date": "2025-03-14", "open": 556.11, "high": 563.83, "low": 551.49, "close": 562.81, "volume": 62660321, "ema_8": 565.14, "ema_21": 578.92, "sma_50": 592.55, "bb_upper": 624.09, "bb_middle": 584.58, "bb_lower": 545.07}, {"date": "2025-03-17", "open": 562.79, "high": 569.71, "low": 562.35, "close": 567.15, "volume": 49008709, "ema_8": 565.58, "ema_21": 577.85, "sma_50": 592.17, "bb_upper": 620.83, "bb_middle": 582.45, "bb_lower": 544.07}, {"date": "2025-03-18", "open": 564.8, "high": 565.02, "low": 559.06, "close": 561.02, "volume": 66041422, "ema_8": 564.57, "ema_21": 576.32, "sma_50": 591.7, "bb_upper": 616.88, "bb_middle": 579.93, "bb_lower": 542.98}, {"date": "2025-03-19", "open": 562.83, "high": 570.95, "low": 561.63, "close": 567.13, "volume": 66555985, "ema_8": 565.14, "ema_21": 575.48, "sma_50": 591.21, "bb_upper": 611.53, "bb_middle": 577.64, "bb_lower": 543.75}, {"date": "2025-03-20", "open": 563.33, "high": 570.57, "low": 562.6, "close": 565.49, "volume": 62958195, "ema_8": 565.22, "ema_21": 574.57, "sma_50": 590.61, "bb_upper": 605.93, "bb_middle": 575.39, "bb_lower": 544.85}, {"date": "2025-03-21", "open": 559.28, "high": 564.89, "low": 558.03, "close": 563.98, "volume": 83762964, "ema_8": 564.94, "ema_21": 573.61, "sma_50": 590.12, "bb_upper": 602.23, "bb_middle": 573.6, "bb_lower": 544.96}, {"date": "2025-03-24", "open": 570.8, "high": 575.15, "low": 570.2, "close": 574.08, "volume": 58766795, "ema_8": 566.97, "ema_21": 573.65, "sma_50": 589.81, "bb_upper": 598.84, "bb_middle": 572.44, "bb_lower": 546.04}, {"date": "2025-03-25", "open": 575.3, "high": 576.41, "low": 573.69, "close": 575.46, "volume": 38355735, "ema_8": 568.86, "ema_21": 573.82, "sma_50": 589.71, "bb_upper": 595.89, "bb_middle": 571.5, "bb_lower": 547.11}, {"date": "2025-03-26", "open": 575.19, "high": 576.33, "low": 567.19, "close": 568.59, "volume": 52228898, "ema_8": 568.8, "ema_21": 573.34, "sma_50": 589.45, "bb_upper": 592.06, "bb_middle": 570.2, "bb_lower": 548.34}, {"date": "2025-03-27", "open": 567.18, "high": 570.9, "low": 564.94, "close": 567.08, "volume": 42164248, "ema_8": 568.42, "ema_21": 572.77, "sma_50": 589.15, "bb_upper": 590.04, "bb_middle": 569.3, "bb_lower": 548.57}, {"date": "2025-03-28", "open": 565.53, "high": 566.27, "low": 555.07, "close": 555.66, "volume": 71662653, "ema_8": 565.58, "ema_21": 571.22, "sma_50": 588.41, "bb_upper": 585.36, "bb_middle": 567.38, "bb_lower": 549.4}, {"date": "2025-03-31", "open": 549.83, "high": 560.71, "low": 546.87, "close": 559.39, "volume": 95328213, "ema_8": 564.21, "ema_21": 570.14, "sma_50": 587.76, "bb_upper": 582.71, "bb_middle": 566.16, "bb_lower": 549.61}, {"date": "2025-04-01", "open": 557.45, "high": 562.94, "low": 553.68, "close": 560.97, "volume": 54609641, "ema_8": 563.49, "ema_21": 569.31, "sma_50": 587.03, "bb_upper": 581.27, "bb_middle": 565.36, "bb_lower": 549.46}, {"date": "2025-04-02", "open": 555.05, "high": 567.42, "low": 554.81, "close": 564.52, "volume": 76014544, "ema_8": 563.72, "ema_21": 568.87, "sma_50": 586.26, "bb_upper": 577.98, "bb_middle": 564.44, "bb_lower": 550.89}, {"date": "2025-04-03", "open": 545.11, "high": 547.97, "low": 536.7, "close": 536.7, "volume": 125985998, "ema_8": 557.71, "ema_21": 565.95, "sma_50": 584.86, "bb_upper": 580.45, "bb_middle": 562.64, "bb_lower": 544.82}, {"date": "2025-04-04", "open": 523.67, "high": 525.87, "low": 505.06, "close": 505.28, "volume": 217965131, "ema_8": 546.06, "ema_21": 560.43, "sma_50": 582.77, "bb_upper": 589.44, "bb_middle": 559.11, "bb_lower": 528.77}, {"date": "2025-04-07", "open": 489.19, "high": 523.17, "low": 481.8, "close": 504.38, "volume": 256611355, "ema_8": 536.8, "ema_21": 555.34, "sma_50": 580.7, "bb_upper": 595.25, "bb_middle": 556.3, "bb_lower": 517.34}, {"date": "2025-04-08", "open": 521.86, "high": 524.98, "low": 489.16, "close": 496.48, "volume": 165816581, "ema_8": 527.84, "ema_21": 549.99, "sma_50": 578.64, "bb_upper": 600.58, "bb_middle": 553.32, "bb_lower": 506.07}, {"date": "2025-04-09", "open": 493.44, "high": 548.62, "low": 493.05, "close": 548.62, "volume": 241867317, "ema_8": 532.46, "ema_21": 549.86, "sma_50": 577.53, "bb_upper": 600.04, "bb_middle": 552.81, "bb_lower": 505.59}, {"date": "2025-04-10", "open": 532.17, "high": 533.5, "low": 509.32, "close": 524.58, "volume": 162331225, "ema_8": 530.71, "ema_21": 547.56, "sma_50": 575.98, "bb_upper": 600.36, "bb_middle": 551.47, "bb_lower": 502.58}, {"date": "2025-04-11", "open": 523.01, "high": 536.43, "low": 520.07, "close": 533.94, "volume": 97866334, "ema_8": 531.43, "ema_21": 546.33, "sma_50": 574.56, "bb_upper": 599.21, "bb_middle": 550.02, "bb_lower": 500.84}, {"date": "2025-04-14", "open": 544.05, "high": 544.28, "low": 533.86, "close": 539.12, "volume": 68033993, "ema_8": 533.14, "ema_21": 545.67, "sma_50": 573.31, "bb_upper": 597.35, "bb_middle": 548.62, "bb_lower": 499.9}, {"date": "2025-04-15", "open": 539.67, "high": 543.23, "low": 536.81, "close": 537.61, "volume": 56892874, "ema_8": 534.13, "ema_21": 544.94, "sma_50": 572.1, "bb_upper": 596.05, "bb_middle": 547.45, "bb_lower": 498.86}, {"date": "2025-04-16", "open": 531.68, "high": 537.89, "low": 520.29, "close": 525.66, "volume": 83484814, "ema_8": 532.25, "ema_21": 543.19, "sma_50": 570.58, "bb_upper": 593.98, "bb_middle": 545.38, "bb_lower": 496.78}, {"date": "2025-04-17", "open": 527.64, "high": 531.16, "low": 523.91, "close": 526.41, "volume": 79868083, "ema_8": 530.95, "ema_21": 541.66, "sma_50": 569.02, "bb_upper": 591.76, "bb_middle": 543.43, "bb_lower": 495.09}, {"date": "2025-04-21", "open": 521.16, "high": 521.7, "low": 508.46, "close": 513.88, "volume": 69368129, "ema_8": 527.16, "ema_21": 539.13, "sma_50": 567.18, "bb_upper": 589.96, "bb_middle": 540.92, "bb_lower": 491.88}, {"date": "2025-04-22", "open": 520.14, "high": 529.3, "low": 519.19, "close": 527.25, "volume": 75948117, "ema_8": 527.18, "ema_21": 538.05, "sma_50": 565.71, "bb_upper": 585.37, "bb_middle": 538.58, "bb_lower": 491.79}, {"date": "2025-04-23", "open": 540.43, "high": 545.43, "low": 533.88, "close": 535.42, "volume": 90590658, "ema_8": 529.01, "ema_21": 537.81, "sma_50": 564.32, "bb_upper": 580.03, "bb_middle": 536.58, "bb_lower": 493.12}, {"date": "2025-04-24", "open": 536.72, "high": 547.43, "low": 535.45, "close": 546.69, "volume": 64150418, "ema_8": 532.94, "ema_21": 538.62, "sma_50": 563.14, "bb_upper": 576.58, "bb_middle": 535.48, "bb_lower": 494.39}, {"date": "2025-04-25", "open": 546.65, "high": 551.05, "low": 543.69, "close": 550.64, "volume": 61119590, "ema_8": 536.87, "ema_21": 539.71, "sma_50": 562.09, "bb_upper": 573.7, "bb_middle": 534.66, "bb_lower": 495.62}, {"date": "2025-04-28", "open": 551.39, "high": 553.55, "low": 545.02, "close": 550.85, "volume": 47613755, "ema_8": 539.98, "ema_21": 540.73, "sma_50": 560.91, "bb_upper": 572.97, "bb_middle": 534.42, "bb_lower": 495.87}, {"date": "2025-04-29", "open": 548.91, "high": 555.45, "low": 548.55, "close": 554.32, "volume": 47775121, "ema_8": 543.17, "ema_21": 541.96, "sma_50": 559.8, "bb_upper": 572.09, "bb_middle": 534.17, "bb_lower": 496.24}, {"date": "2025-04-30", "open": 547.57, "high": 556.52, "low": 541.52, "close": 554.54, "volume": 93101463, "ema_8": 545.69, "ema_21": 543.11, "sma_50": 558.67, "bb_upper": 570.91, "bb_middle": 533.84, "bb_lower": 496.78}, {"date": "2025-05-01", "open": 560.37, "high": 564.07, "low": 557.86, "close": 558.47, "volume": 63186146, "ema_8": 548.53, "ema_21": 544.5, "sma_50": 557.58, "bb_upper": 569.64, "bb_middle": 533.54, "bb_lower": 497.44}, {"date": "2025-05-02", "open": 564.73, "high": 568.38, "low": 562.38, "close": 566.76, "volume": 60717270, "ema_8": 552.58, "ema_21": 546.53, "sma_50": 556.7, "bb_upper": 574.08, "bb_middle": 535.04, "bb_lower": 496.01}, {"date": "2025-05-05", "open": 562.57, "high": 566.65, "low": 561.7, "close": 563.51, "volume": 38659222, "ema_8": 555.01, "ema_21": 548.07, "sma_50": 555.98, "bb_upper": 576.33, "bb_middle": 537.96, "bb_lower": 499.59}, {"date": "2025-05-06", "open": 557.93, "high": 563.35, "low": 556.96, "close": 558.8, "volume": 48264708, "ema_8": 555.85, "ema_21": 549.05, "sma_50": 555.21, "bb_upper": 576.67, "bb_middle": 540.68, "bb_lower": 504.69}, {"date": "2025-05-07", "open": 560.15, "high": 563.82, "low": 556.04, "close": 561.15, "volume": 55733229, "ema_8": 557.03, "ema_21": 550.15, "sma_50": 554.55, "bb_upper": 574.38, "bb_middle": 543.91, "bb_lower": 513.45}, {"date": "2025-05-08", "open": 565.24, "high": 570.31, "low": 561.7, "close": 565.06, "volume": 65130787, "ema_8": 558.81, "ema_21": 551.5, "sma_50": 553.96, "bb_upper": 576.59, "bb_middle": 544.73, "bb_lower": 512.88}, {"date": "2025-05-09", "open": 566.48, "high": 567.5, "low": 562.76, "close": 564.34, "volume": 37603427, "ema_8": 560.04, "ema_21": 552.67, "sma_50": 553.54, "bb_upper": 578.24, "bb_middle": 546.72, "bb_lower": 515.2}, {"date": "2025-05-12", "open": 581.47, "high": 583.0, "low": 577.04, "close": 582.99, "volume": 78993570, "ema_8": 565.14, "ema_21": 555.43, "sma_50": 553.32, "bb_upper": 583.97, "bb_middle": 549.17, "bb_lower": 514.38}, {"date": "2025-05-13", "open": 583.41, "high": 589.08, "low": 582.84, "close": 586.84, "volume": 67947225, "ema_8": 569.96, "ema_21": 558.28, "sma_50": 553.38, "bb_upper": 589.82, "bb_middle": 551.56, "bb_lower": 513.29}, {"date": "2025-05-14", "open": 587.81, "high": 588.98, "low": 585.53, "close": 587.59, "volume": 66283531, "ema_8": 573.88, "ema_21": 560.95, "sma_50": 553.59, "bb_upper": 594.93, "bb_middle": 554.06, "bb_lower": 513.19}, {"date": "2025-05-15", "open": 585.56, "high": 590.97, "low": 585.1, "close": 590.46, "volume": 71268145, "ema_8": 577.56, "ema_21": 563.63, "sma_50": 553.74, "bb_upper": 598.95, "bb_middle": 557.3, "bb_lower": 515.64}, {"date": "2025-05-16", "open": 591.25, "high": 594.5, "low": 589.28, "close": 594.2, "volume": 76052101, "ema_8": 581.26, "ema_21": 566.41, "sma_50": 554.17, "bb_upper": 602.79, "bb_middle": 560.69, "bb_lower": 518.59}, {"date": "2025-05-19", "open": 588.1, "high": 595.54, "low": 588.1, "close": 594.85, "volume": 68168509, "ema_8": 584.28, "ema_21": 568.99, "sma_50": 554.55, "bb_upper": 603.31, "bb_middle": 564.74, "bb_lower": 526.16}, {"date": "2025-05-20", "open": 593.09, "high": 594.05, "low": 589.6, "close": 592.85, "volume": 60614492, "ema_8": 586.19, "ema_21": 571.16, "sma_50": 555.2, "bb_upper": 604.26, "bb_middle": 568.02, "bb_lower": 531.78}, {"date": "2025-05-21", "open": 588.44, "high": 592.58, "low": 581.82, "close": 582.86, "volume": 95197657, "ema_8": 585.45, "ema_21": 572.23, "sma_50": 555.73, "bb_upper": 603.74, "bb_middle": 570.39, "bb_lower": 537.04}, {"date": "2025-05-22", "open": 582.66, "high": 586.62, "low": 581.4, "close": 583.09, "volume": 70860417, "ema_8": 584.92, "ema_21": 573.21, "sma_50": 556.22, "bb_upper": 604.05, "bb_middle": 572.21, "bb_lower": 540.36}]};
        const qqqData = {"symbol": "QQQ", "data": [{"date": "2025-02-24", "open": 527.88, "high": 529.07, "low": 519.53, "close": 519.87, "volume": 39268392, "ema_8": 529.99, "ema_21": 528.13, "sma_50": 523.6, "bb_upper": 542.16, "bb_middle": 527.29, "bb_lower": 512.42}, {"date": "2025-02-25", "open": 519.24, "high": 519.32, "low": 509.44, "close": 513.32, "volume": 48940025, "ema_8": 526.29, "ema_21": 526.78, "sma_50": 523.46, "bb_upper": 542.29, "bb_middle": 527.25, "bb_lower": 512.2}, {"date": "2025-02-26", "open": 515.53, "high": 519.66, "low": 511.37, "close": 514.56, "volume": 34457618, "ema_8": 523.68, "ema_21": 525.67, "sma_50": 523.15, "bb_upper": 542.8, "bb_middle": 526.88, "bb_lower": 510.96}, {"date": "2025-02-27", "open": 518.13, "high": 519.07, "low": 500.05, "close": 500.27, "volume": 52447966, "ema_8": 518.48, "ema_21": 523.36, "sma_50": 522.63, "bb_upper": 545.61, "bb_middle": 525.86, "bb_lower": 506.1}, {"date": "2025-02-28", "open": 500.13, "high": 508.78, "low": 496.93, "close": 508.17, "volume": 47654043, "ema_8": 516.19, "ema_21": 521.98, "sma_50": 522.18, "bb_upper": 546.38, "bb_middle": 525.11, "bb_lower": 503.85}, {"date": "2025-03-03", "open": 511.52, "high": 513.04, "low": 493.58, "close": 497.05, "volume": 44587204, "ema_8": 511.93, "ema_21": 519.71, "sma_50": 521.36, "bb_upper": 548.54, "bb_middle": 523.85, "bb_lower": 499.16}, {"date": "2025-03-04", "open": 494.18, "high": 503.74, "low": 487.74, "close": 495.55, "volume": 67875402, "ema_8": 508.29, "ema_21": 517.52, "sma_50": 520.55, "bb_upper": 550.4, "bb_middle": 522.72, "bb_lower": 495.05}, {"date": "2025-03-05", "open": 496.2, "high": 503.63, "low": 491.26, "close": 502.01, "volume": 46323725, "ema_8": 506.9, "ema_21": 516.11, "sma_50": 520.26, "bb_upper": 550.76, "bb_middle": 521.6, "bb_lower": 492.44}, {"date": "2025-03-06", "open": 493.69, "high": 498.58, "low": 486.2, "close": 488.2, "volume": 57574332, "ema_8": 502.74, "ema_21": 513.57, "sma_50": 519.74, "bb_upper": 552.28, "bb_middle": 519.67, "bb_lower": 487.05}, {"date": "2025-03-07", "open": 487.16, "high": 493.28, "low": 480.53, "close": 491.79, "volume": 54714726, "ema_8": 500.31, "ema_21": 511.59, "sma_50": 519.21, "bb_upper": 552.29, "bb_middle": 517.77, "bb_lower": 483.26}, {"date": "2025-03-10", "open": 483.45, "high": 483.97, "low": 468.66, "close": 472.73, "volume": 76668029, "ema_8": 494.18, "ema_21": 508.06, "sma_50": 518.2, "bb_upper": 555.1, "bb_middle": 515.27, "bb_lower": 475.44}, {"date": "2025-03-11", "open": 472.35, "high": 478.81, "low": 467.01, "close": 471.6, "volume": 68760771, "ema_8": 489.16, "ema_21": 504.74, "sma_50": 517.04, "bb_upper": 556.11, "bb_middle": 512.38, "bb_lower": 468.66}, {"date": "2025-03-12", "open": 479.16, "high": 481.06, "low": 471.79, "close": 476.92, "volume": 46971082, "ema_8": 486.44, "ema_21": 502.21, "sma_50": 515.98, "bb_upper": 555.63, "bb_middle": 509.83, "bb_lower": 464.03}, {"date": "2025-03-13", "open": 476.25, "high": 476.28, "low": 466.43, "close": 468.34, "volume": 46563349, "ema_8": 482.42, "ema_21": 499.13, "sma_50": 514.9, "bb_upper": 555.31, "bb_middle": 506.83, "bb_lower": 458.35}, {"date": "2025-03-14", "open": 473.73, "high": 480.56, "low": 473.12, "close": 479.66, "volume": 43563010, "ema_8": 481.81, "ema_21": 497.36, "sma_50": 514.18, "bb_upper": 551.92, "bb_middle": 504.02, "bb_lower": 456.12}, {"date": "2025-03-17", "open": 479.61, "high": 485.84, "low": 477.8, "close": 482.77, "volume": 41744354, "ema_8": 482.02, "ema_21": 496.04, "sma_50": 513.61, "bb_upper": 547.21, "bb_middle": 501.25, "bb_lower": 455.29}, {"date": "2025-03-18", "open": 479.41, "high": 479.61, "low": 472.41, "close": 474.54, "volume": 39072265, "ema_8": 480.36, "ema_21": 494.08, "sma_50": 512.9, "bb_upper": 541.74, "bb_middle": 498.01, "bb_lower": 454.28}, {"date": "2025-03-19", "open": 476.81, "high": 485.33, "low": 474.87, "close": 480.89, "volume": 40430334, "ema_8": 480.48, "ema_21": 492.88, "sma_50": 512.14, "bb_upper": 534.76, "bb_middle": 495.08, "bb_lower": 455.39}, {"date": "2025-03-20", "open": 476.88, "high": 484.55, "low": 476.18, "close": 479.26, "volume": 36780549, "ema_8": 480.21, "ema_21": 491.65, "sma_50": 511.24, "bb_upper": 527.08, "bb_middle": 492.18, "bb_lower": 457.28}, {"date": "2025-03-21", "open": 474.08, "high": 481.61, "low": 472.9, "close": 480.84, "volume": 42234874, "ema_8": 480.35, "ema_21": 490.66, "sma_50": 510.55, "bb_upper": 521.25, "bb_middle": 489.92, "bb_lower": 458.58}, {"date": "2025-03-24", "open": 487.74, "high": 491.51, "low": 484.4, "close": 490.66, "volume": 34567186, "ema_8": 482.64, "ema_21": 490.66, "sma_50": 510.06, "bb_upper": 516.46, "bb_middle": 488.46, "bb_lower": 460.46}, {"date": "2025-03-25", "open": 491.39, "high": 493.62, "low": 490.42, "close": 493.46, "volume": 26035241, "ema_8": 485.04, "ema_21": 490.92, "sma_50": 509.78, "bb_upper": 513.06, "bb_middle": 487.46, "bb_lower": 461.87}, {"date": "2025-03-26", "open": 492.3, "high": 493.16, "low": 482.82, "close": 484.38, "volume": 35043357, "ema_8": 484.9, "ema_21": 490.32, "sma_50": 509.36, "bb_upper": 508.15, "bb_middle": 485.95, "bb_lower": 463.75}, {"date": "2025-03-27", "open": 482.41, "high": 486.58, "low": 480.25, "close": 481.62, "volume": 33469817, "ema_8": 484.17, "ema_21": 489.53, "sma_50": 508.89, "bb_upper": 506.23, "bb_middle": 485.02, "bb_lower": 463.81}, {"date": "2025-03-28", "open": 479.81, "high": 480.52, "low": 468.05, "close": 468.94, "volume": 46363797, "ema_8": 480.78, "ema_21": 487.66, "sma_50": 507.93, "bb_upper": 502.44, "bb_middle": 483.06, "bb_lower": 463.68}, {"date": "2025-03-31", "open": 461.92, "high": 469.86, "low": 457.33, "close": 468.92, "volume": 53000303, "ema_8": 478.15, "ema_21": 485.96, "sma_50": 507.05, "bb_upper": 500.84, "bb_middle": 481.65, "bb_lower": 462.47}, {"date": "2025-04-01", "open": 467.3, "high": 473.63, "low": 464.42, "close": 472.7, "volume": 41156226, "ema_8": 476.94, "ema_21": 484.75, "sma_50": 506.07, "bb_upper": 498.92, "bb_middle": 480.51, "bb_lower": 462.11}, {"date": "2025-04-02", "open": 466.12, "high": 479.56, "low": 465.86, "close": 476.15, "volume": 49894489, "ema_8": 476.76, "ema_21": 483.97, "sma_50": 505.1, "bb_upper": 494.66, "bb_middle": 479.22, "bb_lower": 463.78}, {"date": "2025-04-03", "open": 456.44, "high": 460.07, "low": 450.14, "close": 450.66, "volume": 70456338, "ema_8": 470.96, "ema_21": 480.94, "sma_50": 503.48, "bb_upper": 496.79, "bb_middle": 477.34, "bb_lower": 457.89}, {"date": "2025-04-04", "open": 438.14, "high": 440.37, "low": 422.67, "close": 422.67, "volume": 117088441, "ema_8": 460.23, "ema_21": 475.64, "sma_50": 501.28, "bb_upper": 504.11, "bb_middle": 473.89, "bb_lower": 443.66}, {"date": "2025-04-07", "open": 408.66, "high": 443.14, "low": 402.39, "close": 423.69, "volume": 161556970, "ema_8": 452.11, "ema_21": 470.92, "sma_50": 499.16, "bb_upper": 509.09, "bb_middle": 471.43, "bb_lower": 433.78}, {"date": "2025-04-08", "open": 438.16, "high": 443.14, "low": 409.79, "close": 416.06, "volume": 101248060, "ema_8": 444.1, "ema_21": 465.93, "sma_50": 497.2, "bb_upper": 513.73, "bb_middle": 468.66, "bb_lower": 423.59}, {"date": "2025-04-09", "open": 415.57, "high": 467.83, "low": 415.43, "close": 466.0, "volume": 142876878, "ema_8": 448.97, "ema_21": 465.94, "sma_50": 496.08, "bb_upper": 513.02, "bb_middle": 468.11, "bb_lower": 423.2}, {"date": "2025-04-10", "open": 453.56, "high": 455.59, "low": 432.63, "close": 446.18, "volume": 108384092, "ema_8": 448.35, "ema_21": 464.14, "sma_50": 494.59, "bb_upper": 512.97, "bb_middle": 467.0, "bb_lower": 421.03}, {"date": "2025-04-11", "open": 444.65, "high": 455.79, "low": 441.33, "close": 454.4, "volume": 52483779, "ema_8": 449.69, "ema_21": 463.26, "sma_50": 493.22, "bb_upper": 511.63, "bb_middle": 465.74, "bb_lower": 419.85}, {"date": "2025-04-14", "open": 464.46, "high": 465.05, "low": 452.63, "close": 457.48, "volume": 43941179, "ema_8": 451.42, "ema_21": 462.73, "sma_50": 491.92, "bb_upper": 509.78, "bb_middle": 464.48, "bb_lower": 419.17}, {"date": "2025-04-15", "open": 458.54, "high": 462.38, "low": 456.15, "close": 457.99, "volume": 35404210, "ema_8": 452.88, "ema_21": 462.3, "sma_50": 490.72, "bb_upper": 508.78, "bb_middle": 463.65, "bb_lower": 418.51}, {"date": "2025-04-16", "open": 449.03, "high": 452.62, "low": 437.76, "close": 444.18, "volume": 48980552, "ema_8": 450.95, "ema_21": 460.65, "sma_50": 489.11, "bb_upper": 506.98, "bb_middle": 461.81, "bb_lower": 416.64}, {"date": "2025-04-17", "open": 447.17, "high": 447.75, "low": 441.36, "close": 444.1, "volume": 44837047, "ema_8": 449.43, "ema_21": 459.15, "sma_50": 487.46, "bb_upper": 505.1, "bb_middle": 460.05, "bb_lower": 415.01}, {"date": "2025-04-21", "open": 438.23, "high": 439.08, "low": 427.93, "close": 433.11, "volume": 44149313, "ema_8": 445.8, "ema_21": 456.78, "sma_50": 485.53, "bb_upper": 503.13, "bb_middle": 457.67, "bb_lower": 412.2}, {"date": "2025-04-22", "open": 438.82, "high": 447.58, "low": 437.62, "close": 444.48, "volume": 52304388, "ema_8": 445.51, "ema_21": 455.66, "sma_50": 483.96, "bb_upper": 498.4, "bb_middle": 455.36, "bb_lower": 412.32}, {"date": "2025-04-23", "open": 458.17, "high": 463.38, "low": 452.88, "close": 454.56, "volume": 55801136, "ema_8": 447.52, "ema_21": 455.56, "sma_50": 482.47, "bb_upper": 492.54, "bb_middle": 453.41, "bb_lower": 414.29}, {"date": "2025-04-24", "open": 456.48, "high": 467.66, "low": 455.83, "close": 467.35, "volume": 45956136, "ema_8": 451.93, "ema_21": 456.63, "sma_50": 481.25, "bb_upper": 489.53, "bb_middle": 452.56, "bb_lower": 415.59}, {"date": "2025-04-25", "open": 466.97, "high": 473.09, "low": 465.39, "close": 472.56, "volume": 38697063, "ema_8": 456.51, "ema_21": 458.08, "sma_50": 480.14, "bb_upper": 487.78, "bb_middle": 452.11, "bb_lower": 416.44}, {"date": "2025-04-28", "open": 473.03, "high": 474.81, "low": 466.03, "close": 472.41, "volume": 33550778, "ema_8": 460.04, "ema_21": 459.38, "sma_50": 478.87, "bb_upper": 488.33, "bb_middle": 452.28, "bb_lower": 416.24}, {"date": "2025-04-29", "open": 470.17, "high": 476.42, "low": 469.59, "close": 475.53, "volume": 30613120, "ema_8": 463.49, "ema_21": 460.85, "sma_50": 477.62, "bb_upper": 489.41, "bb_middle": 452.61, "bb_lower": 415.81}, {"date": "2025-04-30", "open": 467.13, "high": 477.2, "low": 462.43, "close": 475.47, "volume": 46810610, "ema_8": 466.15, "ema_21": 462.18, "sma_50": 476.34, "bb_upper": 489.89, "bb_middle": 452.75, "bb_lower": 415.61}, {"date": "2025-05-01", "open": 483.41, "high": 487.18, "low": 480.74, "close": 481.68, "volume": 43316539, "ema_8": 469.6, "ema_21": 463.95, "sma_50": 475.18, "bb_upper": 490.97, "bb_middle": 453.03, "bb_lower": 415.08}, {"date": "2025-05-02", "open": 486.54, "high": 490.91, "low": 484.83, "close": 488.83, "volume": 39218082, "ema_8": 473.87, "ema_21": 466.22, "sma_50": 474.21, "bb_upper": 496.09, "bb_middle": 454.94, "bb_lower": 413.79}, {"date": "2025-05-05", "open": 484.6, "high": 489.03, "low": 484.1, "close": 485.93, "volume": 28309490, "ema_8": 476.55, "ema_21": 468.01, "sma_50": 473.41, "bb_upper": 498.52, "bb_middle": 458.1, "bb_lower": 417.68}, {"date": "2025-05-06", "open": 479.56, "high": 485.05, "low": 478.19, "close": 481.41, "volume": 32786310, "ema_8": 477.63, "ema_21": 469.23, "sma_50": 472.64, "bb_upper": 499.25, "bb_middle": 460.99, "bb_lower": 422.72}, {"date": "2025-05-07", "open": 482.08, "high": 485.8, "low": 476.78, "close": 483.3, "volume": 38109864, "ema_8": 478.89, "ema_21": 470.51, "sma_50": 472.04, "bb_upper": 497.46, "bb_middle": 464.35, "bb_lower": 431.23}, {"date": "2025-05-08", "open": 488.53, "high": 492.7, "low": 484.17, "close": 488.29, "volume": 39577592, "ema_8": 480.98, "ema_21": 472.12, "sma_50": 471.51, "bb_upper": 500.27, "bb_middle": 465.46, "bb_lower": 430.66}, {"date": "2025-05-09", "open": 490.21, "high": 491.54, "low": 486.19, "close": 487.97, "volume": 27767416, "ema_8": 482.53, "ema_21": 473.56, "sma_50": 471.27, "bb_upper": 502.5, "bb_middle": 467.55, "bb_lower": 432.6}, {"date": "2025-05-12", "open": 506.99, "high": 507.89, "low": 501.48, "close": 507.85, "volume": 45090616, "ema_8": 488.16, "ema_21": 476.68, "sma_50": 471.26, "bb_upper": 508.91, "bb_middle": 470.22, "bb_lower": 431.54}, {"date": "2025-05-13", "open": 509.16, "high": 517.39, "low": 508.42, "close": 515.59, "volume": 53269573, "ema_8": 494.26, "ema_21": 480.22, "sma_50": 471.63, "bb_upper": 516.26, "bb_middle": 473.13, "bb_lower": 430.0}, {"date": "2025-05-14", "open": 516.77, "high": 519.23, "low": 515.75, "close": 518.68, "volume": 47014516, "ema_8": 499.68, "ema_21": 483.71, "sma_50": 472.1, "bb_upper": 523.18, "bb_middle": 476.16, "bb_lower": 429.15}, {"date": "2025-05-15", "open": 516.52, "high": 521.93, "low": 515.17, "close": 519.25, "volume": 50153275, "ema_8": 504.03, "ema_21": 486.94, "sma_50": 472.44, "bb_upper": 528.15, "bb_middle": 479.92, "bb_lower": 431.69}, {"date": "2025-05-16", "open": 520.66, "high": 521.7, "low": 517.1, "close": 521.51, "volume": 48394603, "ema_8": 507.92, "ema_21": 490.09, "sma_50": 473.11, "bb_upper": 532.34, "bb_middle": 483.79, "bb_lower": 435.24}, {"date": "2025-05-19", "open": 514.24, "high": 522.53, "low": 514.24, "close": 522.01, "volume": 52536154, "ema_8": 511.05, "ema_21": 492.99, "sma_50": 473.71, "bb_upper": 533.41, "bb_middle": 488.23, "bb_lower": 443.06}, {"date": "2025-05-20", "open": 519.47, "high": 520.93, "low": 516.66, "close": 520.27, "volume": 42517561, "ema_8": 513.1, "ema_21": 495.47, "sma_50": 474.66, "bb_upper": 534.37, "bb_middle": 492.02, "bb_lower": 449.67}, {"date": "2025-05-21", "open": 516.27, "high": 523.0, "low": 511.24, "close": 513.04, "volume": 71292831, "ema_8": 513.08, "ema_21": 497.07, "sma_50": 475.49, "bb_upper": 534.38, "bb_middle": 494.95, "bb_lower": 455.51}, {"date": "2025-05-22", "open": 513.66, "high": 517.71, "low": 512.3, "close": 514.0, "volume": 55607169, "ema_8": 513.29, "ema_21": 498.61, "sma_50": 476.23, "bb_upper": 535.34, "bb_middle": 497.28, "bb_lower": 459.22}]};
        const spyScorecardData = {"v1_scorecard": [{"date": "2025-02-24", "value": 3}, {"date": "2025-02-25", "value": 3}, {"date": "2025-02-26", "value": 3}, {"date": "2025-02-27", "value": 2}, {"date": "2025-02-28", "value": 4}, {"date": "2025-03-03", "value": 3}, {"date": "2025-03-04", "value": 2}, {"date": "2025-03-05", "value": 2}, {"date": "2025-03-06", "value": 2}, {"date": "2025-03-07", "value": 0}, {"date": "2025-03-10", "value": 0}, {"date": "2025-03-11", "value": 0}, {"date": "2025-03-12", "value": 0}, {"date": "2025-03-13", "value": 0}, {"date": "2025-03-14", "value": 0}, {"date": "2025-03-17", "value": 0}, {"date": "2025-03-18", "value": 0}, {"date": "2025-03-19", "value": 1}, {"date": "2025-03-20", "value": 1}, {"date": "2025-03-21", "value": 0}, {"date": "2025-03-24", "value": 0}, {"date": "2025-03-25", "value": 1}, {"date": "2025-03-26", "value": 0}, {"date": "2025-03-27", "value": 1}, {"date": "2025-03-28", "value": 0}, {"date": "2025-03-31", "value": 0}, {"date": "2025-04-01", "value": 0}, {"date": "2025-04-02", "value": 0}, {"date": "2025-04-03", "value": 0}, {"date": "2025-04-04", "value": 0}, {"date": "2025-04-07", "value": 0}, {"date": "2025-04-08", "value": 0}, {"date": "2025-04-09", "value": 0}, {"date": "2025-04-10", "value": 0}, {"date": "2025-04-11", "value": 0}, {"date": "2025-04-14", "value": 0}, {"date": "2025-04-15", "value": 0}, {"date": "2025-04-16", "value": 0}, {"date": "2025-04-17", "value": 0}, {"date": "2025-04-21", "value": 1}, {"date": "2025-04-22", "value": 0}, {"date": "2025-04-23", "value": 0}, {"date": "2025-04-24", "value": 0}, {"date": "2025-04-25", "value": 1}, {"date": "2025-04-28", "value": 2}, {"date": "2025-04-29", "value": 2}, {"date": "2025-04-30", "value": 1}, {"date": "2025-05-01", "value": 1}, {"date": "2025-05-02", "value": 2}, {"date": "2025-05-05", "value": 1}, {"date": "2025-05-06", "value": 1}, {"date": "2025-05-07", "value": 2}, {"date": "2025-05-08", "value": 2}, {"date": "2025-05-09", "value": 2}, {"date": "2025-05-12", "value": 3}, {"date": "2025-05-13", "value": 3}, {"date": "2025-05-14", "value": 1}, {"date": "2025-05-15", "value": 3}, {"date": "2025-05-16", "value": 3}, {"date": "2025-05-19", "value": 3}, {"date": "2025-05-20", "value": 3}, {"date": "2025-05-21", "value": 2}, {"date": "2025-05-22", "value": 2}], "v2_scorecard": [{"date": "2025-02-24", "value": 2}, {"date": "2025-02-25", "value": 2}, {"date": "2025-02-26", "value": 3}, {"date": "2025-02-27", "value": 3}, {"date": "2025-02-28", "value": 2}, {"date": "2025-03-03", "value": 3}, {"date": "2025-03-04", "value": 3}, {"date": "2025-03-05", "value": 2}, {"date": "2025-03-06", "value": 2}, {"date": "2025-03-07", "value": 2}, {"date": "2025-03-10", "value": 2}, {"date": "2025-03-11", "value": 2}, {"date": "2025-03-12", "value": 3}, {"date": "2025-03-13", "value": 3}, {"date": "2025-03-14", "value": 3}, {"date": "2025-03-17", "value": 2}, {"date": "2025-03-18", "value": 2}, {"date": "2025-03-19", "value": 3}, {"date": "2025-03-20", "value": 3}, {"date": "2025-03-21", "value": 3}, {"date": "2025-03-24", "value": 4}, {"date": "2025-03-25", "value": 4}, {"date": "2025-03-26", "value": 4}, {"date": "2025-03-27", "value": 1}, {"date": "2025-03-28", "value": 2}, {"date": "2025-03-31", "value": 1}, {"date": "2025-04-01", "value": 1}, {"date": "2025-04-02", "value": 1}, {"date": "2025-04-03", "value": 1}, {"date": "2025-04-04", "value": 1}, {"date": "2025-04-07", "value": 1}, {"date": "2025-04-08", "value": 2}, {"date": "2025-04-09", "value": 3}, {"date": "2025-04-10", "value": 2}, {"date": "2025-04-11", "value": 3}, {"date": "2025-04-14", "value": 4}, {"date": "2025-04-15", "value": 4}, {"date": "2025-04-16", "value": 3}, {"date": "2025-04-17", "value": 3}, {"date": "2025-04-21", "value": 1}, {"date": "2025-04-22", "value": 2}, {"date": "2025-04-23", "value": 4}, {"date": "2025-04-24", "value": 4}, {"date": "2025-04-25", "value": 4}, {"date": "2025-04-28", "value": 6}, {"date": "2025-04-29", "value": 6}, {"date": "2025-04-30", "value": 5}, {"date": "2025-05-01", "value": 5}, {"date": "2025-05-02", "value": 6}, {"date": "2025-05-05", "value": 6}, {"date": "2025-05-06", "value": 5}, {"date": "2025-05-07", "value": 5}, {"date": "2025-05-08", "value": 6}, {"date": "2025-05-09", "value": 5}, {"date": "2025-05-12", "value": 6}, {"date": "2025-05-13", "value": 6}, {"date": "2025-05-14", "value": 5}, {"date": "2025-05-15", "value": 6}, {"date": "2025-05-16", "value": 6}, {"date": "2025-05-19", "value": 6}, {"date": "2025-05-20", "value": 6}, {"date": "2025-05-21", "value": 6}, {"date": "2025-05-22", "value": 4}]};
        const qqqScorecardData = {"v1_scorecard": [{"date": "2025-02-24", "value": 3}, {"date": "2025-02-25", "value": 3}, {"date": "2025-02-26", "value": 3}, {"date": "2025-02-27", "value": 2}, {"date": "2025-02-28", "value": 4}, {"date": "2025-03-03", "value": 3}, {"date": "2025-03-04", "value": 2}, {"date": "2025-03-05", "value": 2}, {"date": "2025-03-06", "value": 2}, {"date": "2025-03-07", "value": 0}, {"date": "2025-03-10", "value": 0}, {"date": "2025-03-11", "value": 0}, {"date": "2025-03-12", "value": 0}, {"date": "2025-03-13", "value": 0}, {"date": "2025-03-14", "value": 0}, {"date": "2025-03-17", "value": 0}, {"date": "2025-03-18", "value": 0}, {"date": "2025-03-19", "value": 1}, {"date": "2025-03-20", "value": 1}, {"date": "2025-03-21", "value": 0}, {"date": "2025-03-24", "value": 0}, {"date": "2025-03-25", "value": 1}, {"date": "2025-03-26", "value": 0}, {"date": "2025-03-27", "value": 1}, {"date": "2025-03-28", "value": 0}, {"date": "2025-03-31", "value": 0}, {"date": "2025-04-01", "value": 0}, {"date": "2025-04-02", "value": 0}, {"date": "2025-04-03", "value": 0}, {"date": "2025-04-04", "value": 0}, {"date": "2025-04-07", "value": 0}, {"date": "2025-04-08", "value": 0}, {"date": "2025-04-09", "value": 0}, {"date": "2025-04-10", "value": 0}, {"date": "2025-04-11", "value": 0}, {"date": "2025-04-14", "value": 0}, {"date": "2025-04-15", "value": 0}, {"date": "2025-04-16", "value": 0}, {"date": "2025-04-17", "value": 0}, {"date": "2025-04-21", "value": 1}, {"date": "2025-04-22", "value": 0}, {"date": "2025-04-23", "value": 0}, {"date": "2025-04-24", "value": 0}, {"date": "2025-04-25", "value": 1}, {"date": "2025-04-28", "value": 2}, {"date": "2025-04-29", "value": 2}, {"date": "2025-04-30", "value": 1}, {"date": "2025-05-01", "value": 1}, {"date": "2025-05-02", "value": 2}, {"date": "2025-05-05", "value": 1}, {"date": "2025-05-06", "value": 1}, {"date": "2025-05-07", "value": 2}, {"date": "2025-05-08", "value": 2}, {"date": "2025-05-09", "value": 2}, {"date": "2025-05-12", "value": 3}, {"date": "2025-05-13", "value": 3}, {"date": "2025-05-14", "value": 1}, {"date": "2025-05-15", "value": 3}, {"date": "2025-05-16", "value": 3}, {"date": "2025-05-19", "value": 3}, {"date": "2025-05-20", "value": 3}, {"date": "2025-05-21", "value": 2}, {"date": "2025-05-22", "value": 2}], "v2_scorecard": [{"date": "2025-02-24", "value": 2}, {"date": "2025-02-25", "value": 2}, {"date": "2025-02-26", "value": 3}, {"date": "2025-02-27", "value": 3}, {"date": "2025-02-28", "value": 2}, {"date": "2025-03-03", "value": 3}, {"date": "2025-03-04", "value": 3}, {"date": "2025-03-05", "value": 2}, {"date": "2025-03-06", "value": 2}, {"date": "2025-03-07", "value": 2}, {"date": "2025-03-10", "value": 2}, {"date": "2025-03-11", "value": 2}, {"date": "2025-03-12", "value": 3}, {"date": "2025-03-13", "value": 3}, {"date": "2025-03-14", "value": 3}, {"date": "2025-03-17", "value": 2}, {"date": "2025-03-18", "value": 2}, {"date": "2025-03-19", "value": 3}, {"date": "2025-03-20", "value": 3}, {"date": "2025-03-21", "value": 3}, {"date": "2025-03-24", "value": 4}, {"date": "2025-03-25", "value": 4}, {"date": "2025-03-26", "value": 4}, {"date": "2025-03-27", "value": 1}, {"date": "2025-03-28", "value": 2}, {"date": "2025-03-31", "value": 1}, {"date": "2025-04-01", "value": 1}, {"date": "2025-04-02", "value": 1}, {"date": "2025-04-03", "value": 1}, {"date": "2025-04-04", "value": 1}, {"date": "2025-04-07", "value": 1}, {"date": "2025-04-08", "value": 2}, {"date": "2025-04-09", "value": 3}, {"date": "2025-04-10", "value": 2}, {"date": "2025-04-11", "value": 3}, {"date": "2025-04-14", "value": 4}, {"date": "2025-04-15", "value": 4}, {"date": "2025-04-16", "value": 3}, {"date": "2025-04-17", "value": 3}, {"date": "2025-04-21", "value": 1}, {"date": "2025-04-22", "value": 2}, {"date": "2025-04-23", "value": 4}, {"date": "2025-04-24", "value": 4}, {"date": "2025-04-25", "value": 4}, {"date": "2025-04-28", "value": 6}, {"date": "2025-04-29", "value": 6}, {"date": "2025-04-30", "value": 5}, {"date": "2025-05-01", "value": 5}, {"date": "2025-05-02", "value": 6}, {"date": "2025-05-05", "value": 6}, {"date": "2025-05-06", "value": 5}, {"date": "2025-05-07", "value": 5}, {"date": "2025-05-08", "value": 6}, {"date": "2025-05-09", "value": 5}, {"date": "2025-05-12", "value": 6}, {"date": "2025-05-13", "value": 6}, {"date": "2025-05-14", "value": 5}, {"date": "2025-05-15", "value": 6}, {"date": "2025-05-16", "value": 6}, {"date": "2025-05-19", "value": 6}, {"date": "2025-05-20", "value": 6}, {"date": "2025-05-21", "value": 6}, {"date": "2025-05-22", "value": 4}]};
        // TradingView-style color scheme
        const COLORS = {
            bg: '#1a1a1a',
            grid: '#333333',
            text: '#ffffff',
            green: '#26A69A',
            red: '#EF5350',
            volume: '#434651',
            ema8: '#B0B0B0',     // Light gray
            ema21: '#D8BFD8',    // Light purple
            sma50: '#FFEB3B',
            bb_upper: '#4CAF50',
            bb_middle: '#2196F3',
            bb_lower: '#F44336',
            v1_scorecard: '#2196F3',
            v2_scorecard: '#9C27B0'
        };
        class CandlestickChart {
            constructor(containerId, data, scorecardData) {
                this.container = document.getElementById(containerId);
                this.data = data;
                this.scorecardData = scorecardData;
                this.width = this.container.clientWidth;
                this.height = this.container.clientHeight || 640;
                this.margin = { top: 10, right: 10, bottom: 30, left: 10 };
                this.chartWidth = this.width - this.margin.left - this.margin.right;
                this.chartHeight = this.height - this.margin.top - this.margin.bottom;
                this.setupScales();
                this.render();
            }
            setupScales() {
                if (!this.data || !this.data.data || this.data.data.length === 0) {
                    return;
                }
                const prices = this.data.data;
                const priceRange = this.getPriceRange(prices);
                const volumeRange = this.getVolumeRange(prices);
                this.xScale = (i) => (i / (prices.length - 1)) * this.chartWidth;
                this.yScale = (price) => this.chartHeight * 0.7 * (1 - (price - priceRange.min) / (priceRange.max - priceRange.min));
                this.volumeScale = (volume) => (this.chartHeight * 0.25) * (volume / volumeRange.max);
            }
            getPriceRange(prices) {
                const allPrices = [];
                prices.forEach(p => {
                    allPrices.push(p.high, p.low, p.open, p.close);
                    if (p.ema_8) allPrices.push(p.ema_8);
                    if (p.ema_21) allPrices.push(p.ema_21);
                    if (p.sma_50) allPrices.push(p.sma_50);
                    if (p.bb_upper) allPrices.push(p.bb_upper);
                    if (p.bb_lower) allPrices.push(p.bb_lower);
                });
                return { min: Math.min(...allPrices), max: Math.max(...allPrices) };
            }
            
            getVolumeRange(prices) {
                const volumes = prices.map(p => p.volume);
                return { min: Math.min(...volumes), max: Math.max(...volumes) };
            }
            
            render() {
                if (!this.data || !this.data.data || this.data.data.length === 0) {
                    this.container.innerHTML = '<div style="color: white; text-align: center; padding: 50px;">No chart data available</div>';
                    return;
                }
                
                    // Create SVG with fixed pixel width for proper alignment
                    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    svg.setAttribute('width', `${this.width}`);
                    svg.setAttribute('height', `${this.height}`);
                    svg.style.backgroundColor = COLORS.bg;
                    svg.style.display = 'block';
                    svg.style.margin = '0 auto';
                
                // Create tooltip element
                this.tooltip = document.createElement('div');
                this.tooltip.style.cssText = `
                    position: absolute;
                    background: rgba(0,0,0,0.92);
                    color: #fff;
                    padding: 7px 12px;
                    border-radius: 5px;
                    font-size: 13px;
                    pointer-events: none;
                    opacity: 0;
                    z-index: 1000;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                    transition: opacity 0.2s;
                    white-space: pre;
                `;
                this.container.style.position = 'relative';
                
                // Create main chart group
                const chartGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                chartGroup.setAttribute('transform', `translate(${this.margin.left}, ${this.margin.top})`);
                
                // Draw grid
                this.drawGrid(chartGroup);
                
                // Draw Bollinger Bands
                this.drawBollingerBands(chartGroup);
                
                // Draw moving averages
                this.drawMovingAverages(chartGroup);
                
                // Draw candlesticks
                this.drawCandlesticks(chartGroup);
                
                // Draw volume
                this.drawVolume(chartGroup);
                
                // Draw scorecard overlays
                this.drawScorecardOverlays(chartGroup);
                
                // Draw axes
                this.drawAxes(chartGroup);
                
                // Draw legend
                this.drawLegend(chartGroup);
                
                svg.appendChild(chartGroup);
                this.container.innerHTML = '';
                this.container.appendChild(this.tooltip);
                this.container.appendChild(svg);
            }
            
            drawGrid(group) {
                // Horizontal grid lines
                for (let i = 0; i <= 10; i++) {
                    const y = (i / 10) * this.chartHeight * 0.7;
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', 0);
                    line.setAttribute('x2', this.chartWidth);
                    line.setAttribute('y1', y);
                    line.setAttribute('y2', y);
                    line.setAttribute('stroke', COLORS.grid);
                    line.setAttribute('stroke-width', 0.5);
                    group.appendChild(line);
                }
                
                // Vertical grid lines  
                const dataLength = this.data.data.length;
                for (let i = 0; i < dataLength; i += Math.floor(dataLength / 6)) {
                    const x = this.xScale(i);
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', x);
                    line.setAttribute('x2', x);
                    line.setAttribute('y1', 0);
                    line.setAttribute('y2', this.chartHeight);
                    line.setAttribute('stroke', COLORS.grid);
                    line.setAttribute('stroke-width', 0.5);
                    group.appendChild(line);
                }
            }
            
            drawCandlesticks(group) {
                this.data.data.forEach((candle, i) => {
                    const x = this.xScale(i);
                    const candleWidth = Math.max(1, this.chartWidth / this.data.data.length * 0.8);
                    
                    const openY = this.yScale(candle.open);
                    const closeY = this.yScale(candle.close);
                    const highY = this.yScale(candle.high);
                    const lowY = this.yScale(candle.low);
                    
                    const isGreen = candle.close >= candle.open;
                    const color = isGreen ? COLORS.green : COLORS.red;
                    
                    // Create a group for each candlestick to handle hover events
                    const candleGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    candleGroup.style.cursor = 'pointer';
                    
                    // Draw high-low line
                    const wickLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    wickLine.setAttribute('x1', x);
                    wickLine.setAttribute('x2', x);
                    wickLine.setAttribute('y1', highY);
                    wickLine.setAttribute('y2', lowY);
                    wickLine.setAttribute('stroke', color);
                    wickLine.setAttribute('stroke-width', 1);
                    candleGroup.appendChild(wickLine);
                    
                    // Draw body
                    const bodyHeight = Math.abs(closeY - openY);
                    const bodyY = Math.min(openY, closeY);
                    
                    const body = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    body.setAttribute('x', x - candleWidth/2);
                    body.setAttribute('y', bodyY);
                    body.setAttribute('width', candleWidth);
                    body.setAttribute('height', Math.max(1, bodyHeight));
                    body.setAttribute('fill', color);  // Always fill with color
                    body.setAttribute('stroke', color);
                    body.setAttribute('stroke-width', 1);
                    candleGroup.appendChild(body);
                    
                    // Add invisible hover area for better mouse interaction
                    const hoverArea = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    hoverArea.setAttribute('x', x - candleWidth/2 - 2);
                    hoverArea.setAttribute('y', Math.min(highY, lowY));
                    hoverArea.setAttribute('width', candleWidth + 4);
                    hoverArea.setAttribute('height', Math.abs(highY - lowY) + 4);
                    hoverArea.setAttribute('fill', 'transparent');
                    candleGroup.appendChild(hoverArea);
                    
                    // Add hover event listeners
                    candleGroup.addEventListener('mouseenter', (e) => {
                        this.showTooltip(e, candle);
                    });
                    candleGroup.addEventListener('mouseleave', () => {
                        this.hideTooltip();
                    });
                    candleGroup.addEventListener('mousemove', (e) => {
                        this.updateTooltipPosition(e);
                    });
                    
                    group.appendChild(candleGroup);
                });
            }
            
            drawVolume(group) {
                const volumeBase = this.chartHeight * 0.75;
                this.data.data.forEach((candle, i) => {
                    const x = this.xScale(i);
                    const barWidth = Math.max(1, this.chartWidth / this.data.data.length * 0.8);
                    const barHeight = this.volumeScale(candle.volume);
                    
                    const bar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    bar.setAttribute('x', x - barWidth/2);
                    bar.setAttribute('y', volumeBase);
                    bar.setAttribute('width', barWidth);
                    bar.setAttribute('height', barHeight);
                    bar.setAttribute('fill', COLORS.volume);
                    bar.setAttribute('opacity', 0.6);
                    group.appendChild(bar);
                });
            }
            
            drawMovingAverages(group) {
                this.drawLine(group, 'ema_8', COLORS.ema8, 2, 1, '5,5');    // Dashed light gray
                this.drawLine(group, 'ema_21', COLORS.ema21, 2, 1, '5,5');  // Dashed light purple
                this.drawLine(group, 'sma_50', COLORS.sma50, 2);             // Solid yellow
            }
            
            drawBollingerBands(group) {
                this.drawLine(group, 'bb_upper', COLORS.bb_upper, 1, 0.6);
                this.drawLine(group, 'bb_middle', COLORS.bb_middle, 1, 0.6);
                this.drawLine(group, 'bb_lower', COLORS.bb_lower, 1, 0.6);
            }
            
            drawLine(group, field, color, strokeWidth = 1, opacity = 1, dashArray = null) {
                const points = [];
                this.data.data.forEach((candle, i) => {
                    if (candle[field] !== null && candle[field] !== undefined) {
                        const x = this.xScale(i);
                        const y = this.yScale(candle[field]);
                        points.push(`${x},${y}`);
                    }
                });
                
                if (points.length > 1) {
                    const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
                    polyline.setAttribute('points', points.join(' '));
                    polyline.setAttribute('fill', 'none');
                    polyline.setAttribute('stroke', color);
                    polyline.setAttribute('stroke-width', strokeWidth);
                    polyline.setAttribute('opacity', opacity);
                    if (dashArray) {
                        polyline.setAttribute('stroke-dasharray', dashArray);
                    }
                    group.appendChild(polyline);
                }
            }
            
            drawScorecardOverlays(group) {
                if (this.scorecardData && this.scorecardData.v1_scorecard) {
                    this.drawScorecardLine(group, this.scorecardData.v1_scorecard, COLORS.v1_scorecard);
                }
                if (this.scorecardData && this.scorecardData.v2_scorecard) {
                    this.drawScorecardLine(group, this.scorecardData.v2_scorecard, COLORS.v2_scorecard);
                }
            }
            
            drawScorecardLine(group, scorecardData, color) {
                // Map scorecard data to chart dates
                const scoreByDate = {};
                scorecardData.forEach(item => {
                    scoreByDate[item.date] = item.value;
                });

                // Scale scores to chart height using fixed 0-9 range for both V1 and V2
                const scaleScore = (score) => this.chartHeight * 0.7 * (1 - score / 9);

                const points = [];
                this.data.data.forEach((candle, i) => {
                    const score = scoreByDate[candle.date];
                    if (score !== undefined) {
                        const x = this.xScale(i);
                        const y = scaleScore(score);
                        points.push(`${x},${y}`);
                    }
                });

                if (points.length > 1) {
                    const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
                    polyline.setAttribute('points', points.join(' '));
                    polyline.setAttribute('fill', 'none');
                    polyline.setAttribute('stroke', color);
                    polyline.setAttribute('stroke-width', 3);
                    polyline.setAttribute('opacity', 0.8);
                    group.appendChild(polyline);
                }
            }
            
            drawAxes(group) {
                // Draw scorecard y-axis labels (0-9 range on the right side)
                const scorecardYAxisX = this.chartWidth + 5;
                for (let i = 0; i <= 9; i++) {
                    const y = this.chartHeight * 0.7 * (1 - i / 9);

                    // Add tick mark
                    const tick = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    tick.setAttribute('x1', this.chartWidth);
                    tick.setAttribute('x2', this.chartWidth + 3);
                    tick.setAttribute('y1', y);
                    tick.setAttribute('y2', y);
                    tick.setAttribute('stroke', COLORS.text);
                    tick.setAttribute('stroke-width', 1);
                    group.appendChild(tick);

                    // Add label text
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', scorecardYAxisX);
                    text.setAttribute('y', y + 4);
                    text.setAttribute('font-family', 'Arial, sans-serif');
                    text.setAttribute('font-size', '10');
                    text.setAttribute('fill', COLORS.text);
                    text.textContent = i.toString();
                    group.appendChild(text);
                }
            }
            
            drawLegend(group) {
                // Legend items with colors and labels
                const legendItems = [
                    { label: 'Candlesticks: Green=Up, Red=Down', color: COLORS.green },
                    { label: '8 EMA', color: COLORS.ema8 },
                    { label: '21 EMA', color: COLORS.ema21 },
                    { label: '50 SMA', color: COLORS.sma50 },
                    { label: 'BB Upper', color: COLORS.bb_upper },
                    { label: 'BB Middle', color: COLORS.bb_middle },
                    { label: 'BB Lower', color: COLORS.bb_lower },
                    { label: 'V1 Scorecard', color: COLORS.v1_scorecard },
                    { label: 'V2 Scorecard', color: COLORS.v2_scorecard }
                ];
                
                const legendX = 10;
                const legendY = 10;
                const itemHeight = 14;
                
                // Create legend background
                const legendBg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                legendBg.setAttribute('x', legendX - 5);
                legendBg.setAttribute('y', legendY - 5);
                legendBg.setAttribute('width', 200);
                legendBg.setAttribute('height', legendItems.length * itemHeight + 10);
                legendBg.setAttribute('fill', COLORS.bg);
                legendBg.setAttribute('stroke', COLORS.grid);
                legendBg.setAttribute('stroke-width', 1);
                legendBg.setAttribute('opacity', 0.9);
                group.appendChild(legendBg);
                
                // Add legend items
                legendItems.forEach((item, index) => {
                    const y = legendY + (index * itemHeight);
                    
                    // Color line
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', legendX);
                    line.setAttribute('x2', legendX + 15);
                    line.setAttribute('y1', y + 5);
                    line.setAttribute('y2', y + 5);
                    line.setAttribute('stroke', item.color);
                    line.setAttribute('stroke-width', 2);
                    group.appendChild(line);
                    
                    // Label text
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', legendX + 20);
                    text.setAttribute('y', y + 8);
                    text.setAttribute('font-family', 'Arial, sans-serif');
                    text.setAttribute('font-size', '10');
                    text.setAttribute('fill', COLORS.text);
                    text.textContent = item.label;
                    group.appendChild(text);
                });
            }
            
            showTooltip(event, candle) {
                if (!candle) return;

                // Format volume with commas
                const formatVolume = (vol) => {
                    return vol.toLocaleString('en-US');
                };

                // Format price to 2 decimal places
                const formatPrice = (price) => {
                    return price.toFixed(2);
                };

                // Get scorecard values for this date
                let v1Score = 'N/A';
                let v2Score = 'N/A';

                if (this.scorecardData) {
                    if (this.scorecardData.v1_scorecard) {
                        const v1Item = this.scorecardData.v1_scorecard.find(item => item.date === candle.date);
                        if (v1Item) v1Score = v1Item.value;
                    }
                    if (this.scorecardData.v2_scorecard) {
                        const v2Item = this.scorecardData.v2_scorecard.find(item => item.date === candle.date);
                        if (v2Item) v2Score = v2Item.value;
                    }
                }

                // Build tooltip text
                let tooltipText = `Date: ${candle.date}\n`;
                tooltipText += `Open: ${formatPrice(candle.open)}\n`;
                tooltipText += `High: ${formatPrice(candle.high)}\n`;
                tooltipText += `Low: ${formatPrice(candle.low)}\n`;
                tooltipText += `Close: ${formatPrice(candle.close)}\n`;
                tooltipText += `Volume: ${formatVolume(candle.volume)}\n`;
                tooltipText += `V1 Score: ${v1Score}\n`;
                tooltipText += `V2 Score: ${v2Score}`;

                this.tooltip.textContent = tooltipText;
                this.tooltip.style.opacity = '1';
                this.updateTooltipPosition(event);
            }
            
            hideTooltip() {
                this.tooltip.style.opacity = '0';
            }
            
            updateTooltipPosition(event) {
                const containerRect = this.container.getBoundingClientRect();
                const x = event.clientX - containerRect.left + 10;
                const y = event.clientY - containerRect.top - 10;
                
                this.tooltip.style.left = x + 'px';
                this.tooltip.style.top = y + 'px';
            }
        }
        
        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            new CandlestickChart('spy-chart', spyData, spyScorecardData);
            new CandlestickChart('qqq-chart', qqqData, qqqScorecardData);
        });
    </script>
</body>
</html>
